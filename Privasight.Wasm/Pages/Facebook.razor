@page "/facebook/dashboards/default"

@using Privasight.Wasm.UI
@using Privasight.Model.Shared.DataStructures.Dashboard
@using Privasight.Model.Shared.DataStructures.Interfaces
@using Privasight.Wasm.Services
@using Privasight.Model.Shared.DataStructures
@using Privasight.Model.Shared.Helpers

@inject DataService _dataService

<PageTitle>All Available Facebook Data</PageTitle>

<Dashboard Setting="GetDefaultDashboardSetting()"/>
@code {

	private DashboardSetting GetDefaultDashboardSetting()
	{
		var cardSettings = new HashSet<CardSetting>();

		foreach (var fileWrapperType in _dataService.AvailableFileWrappers.Values)
		{
			CardSetting? card = null;

			if (fileWrapperType.GetInterfaces().Contains(typeof(ISingleItemListFile<StringWrapperDbObj>)))
			{
				var title = ReflectionHelper.GetTitleFromFileWrapper(fileWrapperType);
				card = new CardSetting(title, fileWrapperType.Name, DialogTypes.DataList, CardTypes.WithLineChart);
			}
			else if (fileWrapperType.GetInterfaces().Contains(typeof(ISingleItemListFile)))
			{
				var title = ReflectionHelper.GetTitleFromFileWrapper(fileWrapperType);
				card = new CardSetting(title, fileWrapperType.Name, DialogTypes.DetailedTable, CardTypes.WithLineChart);
			}

			if (card != null)
			{
				cardSettings.Add(card);
			}
		}

		return new DashboardSetting(cardSettings, "All Available Data");
	}
}